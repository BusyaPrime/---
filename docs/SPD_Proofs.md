# Симметричная Положительная Определенность (SPD) в PDE-LAB

Наш любимый Preconditioned Conjugate Gradient (PCG) солвер *математически железобетонно гарантирует* сойтись к ответу только если (и только если!) матрица оператора $A$ одновременно **Симметричная** ($A = A^T$) и **Положительно Определенная** ($x^T A x > 0$ для любых ненулевых $x \ne 0$). Разорвем этот шаблон по фактам.

## Ядерный Неявный Оператор (The Implicit Conduction Operator)
В архитектуре PDE-LAB для чистой диффузии мы маппим следующий оператор:
$$ A \mathbf{u} = \left( I - c \Delta_h \right) \mathbf{u} $$
Где $c = \Delta t \cdot \alpha$ для хардкорного Backward Euler (неявный метод Эйлера).

## 1. Пруф Симметрии ($A = A^T$)
Матрица дискретного Лапласиана $\Delta_h$ тупо ложится на граф смежности (adjacency matrix) равномерной декартовой сетки.
Если узлы $i$ и $j$ — соседи внутри сетки, теплопоток из $i$ в $j$ строго равен потоку из $j$ в $i$ (физика работает).
1.  **Граничные условия Дирихле (Dirichlet BCs)**: Точки на границе жестко выпиливаются из неявной матрицы (система решает СЛАУ только для внутренних узлов `numInteriorUnknowns`). Связи между внутренними узлами абсолютно двунаправленные $\implies A_{i,j} = A_{j,i}$.
2.  **Граничные условия Неймана (Neumann BCs, $\partial u / \partial n = 0$)**: Юзаем метод центральных разностей 2-го порядка для виртуальных узлов (ghost rings): $u_{ghost} = u_{interior}$. Коэффициент с границы элегантно приплюсовывается обратно к диагонали матрицы ($+1$ metric). Внедиагональная симметрия коннектов полностью сохраняется, то есть $A$ остается симметричной вообще без явного lumped-масс хака.

## 2. Пруф Положительной Определенности ($x^T A x > 0$)
Матрица $A$ - это по факту $1 - c\Delta_h$.
Подключаем Круги Гершгорина (Gershgorin's Circle Theorem). Собственные значения (eigenvalues) матрицы $-\Delta_h$ железобетонно лежат в отрезке $[0, 8/h^2]$ — то есть безопасно тусуются в правой полуплоскости.
Следовательно, все собственные значения матрицы $I - c\Delta_h$ строго $\ge 1 > 0$.

Раз все собственные значения строго больше нуля, а матрица глобально симметрична — значит, $A$ неоспоримо **SPD** (Symmetric Positive Definite). 
Это дает нам полное моральное право взять легковесный PCG вместо тяжеленных GMRES/BiCGSTAB, что режет пополам требования к арифметической пропускной способности шины памяти (bandwidth) на каждой итерации. Профит космический.
